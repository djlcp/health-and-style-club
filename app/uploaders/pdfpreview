class DocUploader < Carrierwave::Uploader::Base
  storage :fog
  include Carrierwave::MiniMagick

  def convert_to_image(height, width)
    image = ::Magick::Image.read(current_path + "[0]") [0]
    image.resize_to_fit(height, width).write(current_path)
  end

  version :preview do
    process :convert_to_image(100,100)
    process :convert => :jpg

    def full_filename (for_file = model.source.file)
      super.chomp(File.extname(super)) + '.jpg'
    end
  end
end
